---
title: "Demographic Dynamics: A Visual Journey Through World Bank Stats"
author: "Ghanshyam Thakur"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(ggplot2)
```

## Introduction
### Project 4.1

The global demographic and digital landscape is undergoing a profound transformation, characterized by a complex interplay between socioeconomic development and technological integration. As nations progress through various stages of economic growth, two critical indicators emerge as barometers of this change: the **Birth Rate**, which reflects shifts in social structures and healthcare, and **Internet Usage**, which signals the depth of a country's digital infrastructure and global connectivity.

This report, prepared for the **World Bank**, aims to explore the correlation between these two variables. By utilizing a scatterplot analysis, we will visualize how a nation's fertility trends align with its digital accessibility. Furthermore, by categorizing these countries into their respective **Income Groups** (High, Upper Middle, Lower Middle, and Low Income), we can identify distinct patterns and "digital divides" that define our modern world.

### Project 4.2
While our previous analysis established a clear link between economic status and demographic trends, the World Bank recognizes that Geography plays an equally vital role in shaping a nation’s future. To provide a more granular perspective, our manager has requested a second high-level scatterplot. This update incorporates a new categorical dimension: World Regions.

By transitioning the analysis from "Income Groups" to "Geographic Regions," we aim to identify localized patterns that income levels alone might hide. For example, do countries in Sub-Saharan Africa share similar demographic traits regardless of their individual GDP? Or does South Asia show a unique digital adoption curve compared to Latin America?

Using the newly supplied R vectors, we will merge geographic metadata with our existing demographic dataset. This refined visualization will allow us to map the Digital-Demographic Divide across continents, providing the World Bank with a culturally and geographically nuanced roadmap for targeted infrastructure development.

Through this data-driven approach, we seek to provide insights into how economic prosperity influences both the biological and technological trajectory of global populations.

##  Working Directory Method
Set working directory and read data

WD – by default RStudio goes to save file, open file, save R file

To know the current working directory 

```{r}
getwd() 
```

Now, let us load the data using below

```{r}
stats = read.csv('DemographicData.csv')
```

## The Core Analytical Framework: Data Manipulation & Exploration

```{r}
nrow(stats)
```

**Analysis & Insight:** By executing the nrow(stats) function, we successfully confirmed that the dataset contains 195 rows, representing 195 distinct countries and territories. From a data science perspective, this verifies that the file import was successful and that our analysis is globally representative. This comprehensive scope is vital for a World Bank report, as it ensures that our conclusions regarding birth rates and internet penetration are based on a truly international sample size covering almost every nation on earth


```{r}
ncol(stats)
```
**Analysis & Insight:** By executing ncol(stats), we find that the dataset consists of 5 columns. This confirms the dimensionality of our dataframe and ensures that all key features—Country Name, Country Code, Birth Rate, Internet Users, and Income Group—have been successfully captured. Knowing the column count is a fundamental step in data auditing, as it allows us to verify that our feature set is complete before moving on to structural analysis or visualization.

```{r}
str(stats)
```
**Analysis & Insight:** Executing str(stats) reveals the technical "DNA" of our dataframe. It confirms we are working with 195 observations across 5 distinct variables. More importantly, it identifies the data types: "Birth rate" and "Internet users" are stored as numeric (num), which is essential for performing mathematical calculations and generating our scatterplot. It also shows that categorical data like "Income Group" is currently stored as characters; this insight is critical as it informs our next step of converting these into "Factors" to allow for categorized economic analysis.

```{r}
head(stats)
```
**Analysis & Insight:** Using the head() function allows us to perform a quick "sanity check" to ensure the data was imported without corruption. By examining the first six entries (from Aruba to Argentina), we gain immediate visibility into the real-world variance of our metrics. For instance, we can contrast Aruba’s high internet usage (78.9%) and low birth rate (~10.2) against Afghanistan’s lower connectivity (5.9%) and higher birth rate (~35.2). This initial snapshot validates our research premise: that technological penetration and demographic trends are closely linked to a country's economic standing.

```{r}
tail(stats)
```

**Analysis & Insight:** Using the head() function allows us to perform a quick "sanity check" to ensure the data was imported without corruption. By examining the first six entries (from Aruba to Argentina), we gain immediate visibility into the real-world variance of our metrics. For instance, we can contrast Aruba’s high internet usage (78.9%) and low birth rate (~10.2) against Afghanistan’s lower connectivity (5.9%) and higher birth rate (~35.2). This initial snapshot validates our research premise: that technological penetration and demographic trends are closely linked to a country's economic standing.

```{r}
head(stats ,n=10)
```
**Analysis & Insight:** Executing head(stats, n=10) provides an expanded view of the first ten observations, offering a more comprehensive look at the dataset's initial entries. This broader preview allows us to observe a wider variety of "Income Groups"—ranging from High Income (Aruba, UAE, Australia) to Low Income (Afghanistan) and Lower Middle Income (Armenia). It highlights the immediate diversity in our data, showing that countries within the first ten rows already span multiple continents and economic tiers. This step is crucial for verifying that the numerical formatting for Birth Rates and Internet Usage remains consistent across a larger sample before we proceed to full-scale statistical analysis.

```{r}
tail(stats , n=10)
```


**Analysis & Insight:** By using tail(stats, n=10), we examine the final ten entries of the dataset, which includes countries such as Vietnam, Yemen, South Africa, and Zambia. This step is essential to ensure the data sequence concludes without errors or missing values. Observing this subset reveals a high concentration of Lower Middle and Low Income countries, providing a sharp contrast to the initial rows. For instance, we see very high birth rates in Zambia (35.4) and lower internet penetration in Yemen (20%), which further reinforces the demographic patterns we aim to visualize. This final check confirms that the dataset is structurally sound from beginning to end.

### **Structure of Data: A quick debrief of data **

```{r}
str(stats)
```
**Analysis & Insight:** The str(stats) output provides the technical blueprint of our dataset. It confirms that the object is a 'data.frame' containing 195 observations. Critically, it identifies the data types for each variable: 'Country Name' and 'Country Code' are character strings, while 'Birth rate' and 'Internet users' are numeric. This structural audit is vital because it ensures our quantitative variables are in the correct format for mathematical analysis and indicates that 'Income Group' may require conversion into a factor for categorical plotting.

**Variable Transformation (Factor Conversion)**
```{r}
stats$Income.Group = as.factor(stats$Income.Group)
```
```{r}
levels(stats$Income.Group)
```
**Analysis & Insight:** By converting the 'Income Group' column into a Factor, we have transformed it from a simple text label into a categorical variable with distinct levels. This is a critical step for a Data Scientist because it allows R to recognize the hierarchical nature of economic tiers (High income, Low income, etc.). The levels() function confirms that R now recognizes the four distinct income categories, which will enable us to color-code our scatterplot and perform group-based statistical comparisons effectively.

```{r}
stats$Income.Group[77]
```
**Analysis & Insight:** By using the index stats$Income.Group[77], we can precisely retrieve the data point for a specific entry—in this case, identifying that the 77th country in our dataset belongs to the High income group. This method of indexing is fundamental for a Data Scientist to verify individual records or conduct specific case studies without processing the entire dataframe. It allows us to cross-reference our global findings with individual national data to ensure the accuracy of our demographic model.

**Summary**
```{r}
summary(stats)
```

**Summary**
**Analysis & Insight:** The summary(stats) command provides a comprehensive statistical profile of the global dataset. For our numerical variables, it reveals the wide spread of development: Birth Rates vary from a minimum of 7.9 to a maximum of 49.6 per 1,000 people, while Internet Usage spans from a negligible 0.9% to an impressive 96.5%. The summary also quantifies our categorical data, showing the distribution of countries across the four Income Groups. This mathematical overview is essential for identifying central tendencies and outliers, providing the quantitative foundation needed to interpret the patterns we will see in the final scatterplot.

### **Basic Operations with Data Frames**
```{r}
stats[3:9,]
```
**Analysis & Insight:** Using the slicing operator [3:9, ] allows us to extract a specific contiguous subset of the data. This technique is invaluable for a Data Scientist when performing comparative analysis on a small cluster of countries. In this particular slice, we can observe the demographic statistics for nations like Albania, the United Arab Emirates, and Argentina. By isolating these rows, we can easily compare how a High-income nation like the UAE contrasts with an Upper-middle-income nation like Albania in terms of birth rates and digital connectivity, providing a microscopic view of the broader global trends.


**Accessing Non-Contiguous Observations**

```{r}
stats[c(4,100),]
```

**Analysis & Insight:** By using the combine function c(), we can retrieve specific, non-sequential observations such as the 4th and 100th rows. This targeted retrieval is essential for comparing "extreme" cases or specific outliers within the dataset without having to scan the entire dataframe. It demonstrates the precision of R’s indexing system, enabling the Data Scientist to pull disparate data points together for a side-by-side comparison of their economic and demographic indicators.


### **Mathematical Operations**
```{r}
stats$Birth.rate + stats$Internet.users
```
**Analysis & Insight:** This operation demonstrates the power of Vectorized Arithmetic in R. Instead of using complex loops, we can perform direct mathematical operations across entire columns simultaneously. While the sum of a birth rate (a demographic metric) and internet usage (a technological metric) does not represent a standard socioeconomic index, executing this calculation is a vital technical exercise. It proves that the data is stored in a clean, numerical format and showcases our ability to create "Composite Scores" or derived variables, which are essential for building more complex demographic models in the future.


### **Creating Derived Variables (Feature Engineering)**
```{r}
stats$Mycol = stats$Birth.rate + stats$Internet.users
```
**Analysis & Insight:** By assigning the result of our calculation to stats$Mycal, we are performing Feature Engineering. This allows us to append new, custom-calculated insights directly to our primary dataset. As seen in the head() output, the new variable is seamlessly integrated as a new column. This capability is critical for a Data Scientist when creating custom KPIs (Key Performance Indicators) or normalizing data across different scales to better understand the relationship between a nation's social trends and its digital infrastructure.

```{r}
stats$Mycol = NULL
```
**Analysis & Insight:** In data management, maintaining a clean and efficient dataset is just as important as creating new variables. By assigning NULL to the stats$Mycal column, we effectively drop it from the dataframe. This ensures that our workspace remains uncluttered and prevents redundant or experimental data from interfering with the final analysis.

### **Filtering a data frame**
```{r}
stats$Internet.users < 2
```
**Analysis & Insight:** Filtering is one of the most powerful tools for a Data Scientist to identify specific socioeconomic trends. By creating a logical filter for countries where internet usage is below 2%, we isolate a specific subset of the global population. The resulting output highlights nations that are significantly lagging in the digital race. This targeted view allows the World Bank to identify exactly which regions require the most urgent digital infrastructure investment, transforming a massive dataset into an actionable list of priority countries.

```{r}
stats[stats$Birth.rate > 40 & stats$Internet.users <2,]
```
**Analysis & Insight:** By applying a multi-criteria filter using the "AND" (&) operator, we can isolate countries that face a dual challenge: very high fertility rates and extremely limited digital connectivity. This specific intersection identifies nations that are often in the early stages of the demographic transition and lack the digital infrastructure necessary for modern economic growth. From a policy perspective, this allows the World Bank to pinpoint regions where developmental interventions in both healthcare and technology are most critically needed. The resulting subset provides a stark look at the "digital divide," where a lack of internet access often correlates with traditional demographic patterns.

**Filtering by Economic Classification**
```{r}
stats[stats$Income.Group == "High income",]
```


```{r}
stats[stats$Country.Name == "India",]
```
**Analysis & Insight:** Using the equality operator (==), we can filter the entire dataset to focus exclusively on the High income group. This allows us to establish a "Gold Standard" or benchmark for our analysis. By examining this subset, we observe a consistent trend of high internet penetration and low birth rates, which is characteristic of advanced economies. This focused view is essential for comparative studies, as it provides the data necessary to contrast the demographic behavior of wealthy nations against that of developing or emerging economies.

## Visual Analytics and Correlation Mapping


```{r}
qplot(data = stats, x = Internet.users)
```


```{r}
qplot(data = stats,  x = Income.Group , y = Birth.rate)
```

```{r}
qplot(data = stats , x = Income.Group , y = Birth.rate, size = I(3) )
```

```{r}
qplot(data = stats, x = Income.Group, y = Birth.rate, 
      size = I(3), colour = Income.Group,shape=I(13), alpha = I(0.6),
      main = "Birth Rate Distribution by Income Group",
      xlab = "National Income Classification",
      ylab = "Birth Rate (per 1,000 people)")
```

```{r}
qplot(data = stats, x = Income.Group , y = Birth.rate, geom = "boxplot" , colour = Income.Group)
```


**Analysis & Insight:**
This categorical plot provides a clear cross-sectional view of global fertility trends. By isolating Birth Rate against Income Groups, we observe a distinct "downward staircase" effect.

**The Development Gap:** There is a significant vertical dispersion in 'Low Income' and 'Lower Middle Income' categories, where birth rates remain high and varied.

**Economic Convergence:** As we move toward 'High Income' nations, the red data points become tightly clustered at the bottom of the y-axis. This indicates that economic prosperity acts as a universal stabilizer for population growth, regardless of geographic location.

**Statistical Significance:** The sharp decline in the "ceiling" of these data points across categories suggests that increasing national income is one of the most effective predictors of declining birth rates globally.



### Investigating the relationship between Internet Penetration and Birth Rates
```{r}
qplot(data = stats, x = Internet.users, y = Birth.rate)
```


```{r}
qplot(data = stats, x = Internet.users, y = Birth.rate, size = I(3) , colour = 'red' )
```


```{r}
qplot(data = stats, x = Internet.users, y = Birth.rate ,shape=I(11), size = I(3) , colour = Income.Group)
```

```{r}
qplot(data = stats, x = Internet.users, y = Birth.rate, 
      size = I(3), colour = Income.Group, shape=I(8), alpha = I(0.6),
      main = "Relationship Between Internet Penetration and Birth Rates",
      xlab = "Internet Users (Percentage of Population)",
      ylab = "Birth Rate (per 1,000 People)")
```

**Analysis & Insight:**

The interaction between **Internet Users** (-axis) and **Birth Rate** (-axis) reveals the fundamental mechanics of the modern demographic transition.

* **The Power of Connectivity:** The scatterplot exhibits a strong **negative correlation**. As we move along the -axis, it is evident that as a society becomes more digitally connected, the birth rate consistently drops. This suggests that internet access serves as a proxy for modernization, influencing social behaviors and providing greater access to family planning and educational resources.
* **The Transition Gap:** There is a dense cluster of data points in the high-birth/low-internet region. However, as internet penetration surpasses the **40% threshold**, the variance in birth rates decreases significantly. This "tipping point" indicates that once a certain level of digital infrastructure is achieved, a nation typically enters a more stable, lower-fertility demographic phase.
* **Global Inequality Visualization:** The distribution of points highlights a stark global divide. The "Digital Have-Nots" (low -values) are burdened with higher demographic pressures (high -values), whereas nations with near-universal internet access have largely transitioned to replacement-level fertility or below. This visual evidence supports the World Bank's initiative to bridge the digital gap as a means of promoting long-term demographic and economic stability.

##  Project 4.2

```{r}
Countries_2012_Dataset <- c("Aruba","Afghanistan","Angola","Albania","United Arab Emirates","Argentina","Armenia","Antigua and Barbuda","Australia","Austria","Azerbaijan","Burundi","Belgium","Benin","Burkina Faso","Bangladesh","Bulgaria","Bahrain","Bahamas, The","Bosnia and Herzegovina","Belarus","Belize","Bermuda","Bolivia","Brazil","Barbados","Brunei Darussalam","Bhutan","Botswana","Central African Republic","Canada","Switzerland","Chile","China","Cote d'Ivoire","Cameroon","Congo, Rep.","Colombia","Comoros","Cabo Verde","Costa Rica","Cuba","Cayman Islands","Cyprus","Czech Republic","Germany","Djibouti","Denmark","Dominican Republic","Algeria","Ecuador","Egypt, Arab Rep.","Eritrea","Spain","Estonia","Ethiopia","Finland","Fiji","France","Micronesia, Fed. Sts.","Gabon","United Kingdom","Georgia","Ghana","Guinea","Gambia, The","Guinea-Bissau","Equatorial Guinea","Greece","Grenada","Greenland","Guatemala","Guam","Guyana","Hong Kong SAR, China","Honduras","Croatia","Haiti","Hungary","Indonesia","India","Ireland","Iran, Islamic Rep.","Iraq","Iceland","Israel","Italy","Jamaica","Jordan","Japan","Kazakhstan","Kenya","Kyrgyz Republic","Cambodia","Kiribati","Korea, Rep.","Kuwait","Lao PDR","Lebanon","Liberia","Libya","St. Lucia","Liechtenstein","Sri Lanka","Lesotho","Lithuania","Luxembourg","Latvia","Macao SAR, China","Morocco","Moldova","Madagascar","Maldives","Mexico","Macedonia, FYR","Mali","Malta","Myanmar","Montenegro","Mongolia","Mozambique","Mauritania","Mauritius","Malawi","Malaysia","Namibia","New Caledonia","Niger","Nigeria","Nicaragua","Netherlands","Norway","Nepal","New Zealand","Oman","Pakistan","Panama","Peru","Philippines","Papua New Guinea","Poland","Puerto Rico","Portugal","Paraguay","French Polynesia","Qatar","Romania","Russian Federation","Rwanda","Saudi Arabia","Sudan","Senegal","Singapore","Solomon Islands","Sierra Leone","El Salvador","Somalia","Serbia","South Sudan","Sao Tome and Principe","Suriname","Slovak Republic","Slovenia","Sweden","Swaziland","Seychelles","Syrian Arab Republic","Chad","Togo","Thailand","Tajikistan","Turkmenistan","Timor-Leste","Tonga","Trinidad and Tobago","Tunisia","Turkey","Tanzania","Uganda","Ukraine","Uruguay","United States","Uzbekistan","St. Vincent and the Grenadines","Venezuela, RB","Virgin Islands (U.S.)","Vietnam","Vanuatu","West Bank and Gaza","Samoa","Yemen, Rep.","South Africa","Congo, Dem. Rep.","Zambia","Zimbabwe")
Codes_2012_Dataset <- c("ABW","AFG","AGO","ALB","ARE","ARG","ARM","ATG","AUS","AUT","AZE","BDI","BEL","BEN","BFA","BGD","BGR","BHR","BHS","BIH","BLR","BLZ","BMU","BOL","BRA","BRB","BRN","BTN","BWA","CAF","CAN","CHE","CHL","CHN","CIV","CMR","COG","COL","COM","CPV","CRI","CUB","CYM","CYP","CZE","DEU","DJI","DNK","DOM","DZA","ECU","EGY","ERI","ESP","EST","ETH","FIN","FJI","FRA","FSM","GAB","GBR","GEO","GHA","GIN","GMB","GNB","GNQ","GRC","GRD","GRL","GTM","GUM","GUY","HKG","HND","HRV","HTI","HUN","IDN","IND","IRL","IRN","IRQ","ISL","ISR","ITA","JAM","JOR","JPN","KAZ","KEN","KGZ","KHM","KIR","KOR","KWT","LAO","LBN","LBR","LBY","LCA","LIE","LKA","LSO","LTU","LUX","LVA","MAC","MAR","MDA","MDG","MDV","MEX","MKD","MLI","MLT","MMR","MNE","MNG","MOZ","MRT","MUS","MWI","MYS","NAM","NCL","NER","NGA","NIC","NLD","NOR","NPL","NZL","OMN","PAK","PAN","PER","PHL","PNG","POL","PRI","PRT","PRY","PYF","QAT","ROU","RUS","RWA","SAU","SDN","SEN","SGP","SLB","SLE","SLV","SOM","SRB","SSD","STP","SUR","SVK","SVN","SWE","SWZ","SYC","SYR","TCD","TGO","THA","TJK","TKM","TLS","TON","TTO","TUN","TUR","TZA","UGA","UKR","URY","USA","UZB","VCT","VEN","VIR","VNM","VUT","PSE","WSM","YEM","ZAF","COD","ZMB","ZWE")
Regions_2012_Dataset <- c("The Americas","Asia","Africa","Europe","Middle East","The Americas","Asia","The Americas","Oceania","Europe","Asia","Africa","Europe","Africa","Africa","Asia","Europe","Middle East","The Americas","Europe","Europe","The Americas","The Americas","The Americas","The Americas","The Americas","Asia","Asia","Africa","Africa","The Americas","Europe","The Americas","Asia","Africa","Africa","Africa","The Americas","Africa","Africa","The Americas","The Americas","The Americas","Europe","Europe","Europe","Africa","Europe","The Americas","Africa","The Americas","Africa","Africa","Europe","Europe","Africa","Europe","Oceania","Europe","Oceania","Africa","Europe","Asia","Africa","Africa","Africa","Africa","Africa","Europe","The Americas","The Americas","The Americas","Oceania","The Americas","Asia","The Americas","Europe","The Americas","Europe","Asia","Asia","Europe","Middle East","Middle East","Europe","Middle East","Europe","The Americas","Middle East","Asia","Asia","Africa","Asia","Asia","Oceania","Asia","Middle East","Asia","Middle East","Africa","Africa","The Americas","Europe","Asia","Africa","Europe","Europe","Europe","Asia","Africa","Europe","Africa","Asia","The Americas","Europe","Africa","Europe","Asia","Europe","Asia","Africa","Africa","Africa","Africa","Asia","Africa","Oceania","Africa","Africa","The Americas","Europe","Europe","Asia","Oceania","Middle East","Asia","The Americas","The Americas","Asia","Oceania","Europe","The Americas","Europe","The Americas","Oceania","Middle East","Europe","Europe","Africa","Middle East","Africa","Africa","Asia","Oceania","Africa","The Americas","Africa","Europe","Africa","Africa","The Americas","Europe","Europe","Europe","Africa","Africa","Middle East","Africa","Africa","Asia","Asia","Asia","Asia","Oceania","The Americas","Africa","Europe","Africa","Africa","Europe","The Americas","The Americas","Asia","The Americas","The Americas","The Americas","Asia","Oceania","Middle East","Oceania","Middle East","Africa","Africa","Africa","Africa")
```

```{r}
mydf <- data.frame(Countries_2012_Dataset, Codes_2012_Dataset, 
                   Regions_2012_Dataset)
head(mydf)
```

```{r}
str(mydf)
levels(mydf$Regions_2012_Dataset)
```
```{r}
colnames(mydf) <- c("Country", "Code", "Region")
head(mydf)
```
```{r}
mydf <- data.frame(Country=Countries_2012_Dataset, Code=Codes_2012_Dataset, 
                   Region=Regions_2012_Dataset)
head(mydf)
```
```{r}
summary(mydf)
```
```{r}
merged <- merge(stats, mydf, by.x= "Country.Code", by.y="Code")
head(merged)
head(mydf)
```
```{r}
merged$Country <- NULL
head(merged)
str(merged)
summary(merged)
```

### Birth Rate Vs Internet Users (Different Shapes)


```{r}
qplot(data=merged, x=Internet.users, 
      y=Birth.rate, color=Region, size=I(4), 
      shape=I(20), alpha=I(0.88),
      main="Birth Rate Vs Internet Users")
```


```{r}
qplot(data=merged, x=Internet.users, 
      y=Birth.rate, color=Region, size=I(4), 
      shape=I(7), alpha=I(0.88),
      main="Birth Rate Vs Internet Users")
```


```{r}
qplot(data=merged, x=Internet.users, 
      y=Birth.rate, color=Region, size=I(4), 
      shape=I(8), alpha=I(0.88),
      main="Birth Rate Vs Internet Users")
```

**Key Insights: Birth Rate vs. Internet Users**

The chart reveals a **strong negative correlation**: as internet penetration rises, birth rates plummet.


You can use this concise summary for your R Markdown file to provide a clear, professional overview of the visualization:

**Visualization Analysis: Birth Rate vs. Internet Users**

This scatter plot illustrates the relationship between **Internet Users** (percentage of population) and **Birth Rate** (per 1,000 people), categorized by **Region**.

**Key Observations**

* **Correlation:** There is a strong **negative (inverse) correlation** between the two variables. As internet penetration increases, the birth rate consistently declines.
* **Regional Clustering:**
* **Africa (Red):** Predominantly high birth rates (30–50) and low internet penetration (<25%).
* **Europe (Green):** Concentrated at the bottom-right, with high internet penetration (>60%) and the lowest birth rates (<15).
* **Americas & Asia:** Show the widest variance, representing a middle-ground transition phase.

* **Threshold:** A "tipping point" appears around **50% internet penetration**, where birth rates almost universally drop below 25.
* **Data Density:** The bottom-right quadrant (High Internet / Low Birth Rate) shows significant convergence, indicating a "floor" for birth rates in highly digitized societies.

